# Bumpy Docker build: build app in a Docker image and publish to registry

trigger: none

pool:
  vmImage: 'ubuntu-latest'

variables:
  azureCrUser: 'kadluba'
  azureCrAddress: '$(azureCrUser).azurecr.io'
  dockerImage: 'bumpy:latest'
  dockerTag: '$(azureCrAddress)/samples/$(dockerImage)'

steps:
- script: docker login -u $(azureCrUser) -p $(azureCrPassword) $(azureCrAddress)
  displayName: "Docker ACR Login"

- script: docker build --rm -f "Bumpy/Dockerfile" -t $(dockerTag) Bumpy
  displayName: "Docker Build"

- script: docker push $(dockerTag)
  displayName: "Docker Push Image to ACR"
